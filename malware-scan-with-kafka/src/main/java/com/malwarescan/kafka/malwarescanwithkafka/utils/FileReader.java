package com.malwarescan.kafka.malwarescanwithkafka.utils;

import com.malwarescan.kafka.malwarescanwithkafka.errorresponse.UnacceptableException;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

public class FileReader {
    public static String readFileFromClasspath(String filePath) throws IOException {
        StringBuilder content = new StringBuilder();
        InputStream inputStream = getResourceFileAsInputStream(filePath);// Util.class.getClassLoader().getResourceAsStream(filePath);
        if (inputStream != null) {
            try (BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream))) {
                String line;
                while ((line = reader.readLine()) != null) {
                    if(line.contains("BlackListed"))throw new UnacceptableException("Failure occurs when blacklisted is found!");
                    content.append(line).append("\n");
                }
                reader.close();
            }
            catch (IOException ex) {
                ex.printStackTrace();
            }
        }
        return content.toString();
    }
    public static InputStream getResourceFileAsInputStream(String fileName) {
        ClassLoader classLoader = FileReader.class.getClassLoader();
        return classLoader.getResourceAsStream(fileName);
    }
}
