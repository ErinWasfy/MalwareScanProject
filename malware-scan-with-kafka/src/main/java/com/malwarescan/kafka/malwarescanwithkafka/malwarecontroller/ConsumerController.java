package com.malwarescan.kafka.malwarescanwithkafka.malwarecontroller;

import com.malwarescan.kafka.malwarescanwithkafka.malwarescanservice.ConsumerService;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import javax.ws.rs.core.Response;
import java.io.IOException;

@RestController
@RequestMapping("/rest/doc-consume")
public class ConsumerController {
private final ConsumerService consumerService;

    public ConsumerController(ConsumerService consumerService) {
        this.consumerService = consumerService;
    }

    @GetMapping("/shown-document")
    public ResponseEntity<String> fetchData(@RequestParam("msg") String urlMessage) throws IOException {
       String data= consumerService.consumeMssages(urlMessage);
       if(data!="")
       {
           return new ResponseEntity<String>(data, HttpStatus.OK);
       }
       return new ResponseEntity<String>("No data found",HttpStatus.NO_CONTENT);
    }

}
